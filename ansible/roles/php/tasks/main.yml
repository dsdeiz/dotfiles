---

- homebrew_tap: name=homebrew/php state=present

- homebrew: name={{ item }} state=present
  with_items:
    - php56
    - php56-opcache

- stat: "path={{ composer_path }}"
  register: composer_bin

- get_url:
    url: https://getcomposer.org/installer
    dest: /tmp/composer-installer.php
    mode: 0755
  when: not composer_bin.stat.exists

- command: >
    php composer-installer.php
    chdir=/tmp
  when: not composer_bin.stat.exists

- shell: >
    mv /tmp/composer.phar {{ composer_path }}
    creates={{ composer_path }}
  when: not composer_bin.stat.exists
